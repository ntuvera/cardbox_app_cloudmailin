<h1>Profile page</h1>

<div class="profile header">
  <%= current_user.email %> is logged in.
  <form action="/logout" method='post'>
    <%= token_tag %>
    <input type="hidden" name="_method" value="delete">
    <button class="btn btn-primary" type='submit'>Log Out</button>
  </form>
</div>

<hr>


<% unless current_user.pin %>
  <h1>STEP 1: GET PIN</h1>
  <div class="linkedin_pin">
        <%= link_to "get pin", @authorize_url, target: '_blank' %>
        <form action="/authorize" method="get"> 
          <%= token_tag %>                
          <input type="submit" value="get more info from linkedin">        
        </form>
        <%= @url %> 
  </div>
  <h1>STEP 2: SET PIN</h1>
  <div>
      <%= form_for current_user, remote: true do |f| %>
        <%= f.text_field :pin %>
        <%= f.submit "set pin" %>
      <% end %>
  </div>
<% end %>
<hr>


<div class="img" id="me">
  <img src="<%= current_user.image_url%>" alt="Profile Picture" />
</div>

<!-- if the current_user has supplied a pin, then hide a field
    otherwise, render a field and prompt to input the key.  save the pin to 
    the database.  -->



<div class="cards container">

  <% current_user.cards.each do |card| %>
  <div class="saved card">
    <img class="business-card" src="<%= card.email.attachment_url %>">
    <p><%= card.email.message %></p>
    <div class="contact info">
      <form action="/contacts" method="post"> <!-- post to Contacts to add data into Contact Objects -->
        <%= token_tag %>
        <input type="text" name="name" value="<%= card.email.subject %>">
        <input type="text" name="email" placeholder="JSmith@gmail.com">
        <input type="phone" name="phone" placeholder="(555) 555-5555">
        <input type="text" name="linkedIn" placeholder="LinkedIn ID">
        <textarea name="memo" cols="20" rows="1"><%= card.email.message %></textarea>
        <input type="url" name="card_image_url" value="<%= card.email.attachment_url %>">
        <input type="submit" value="Create Contact">
        <!-- add more for fields for if including more data on contact -->
      </form>
    </div>
  </div>

</div>
<% end %>

</div>


